/*
  struct.js ver0.1

  This module use Proxy API provided by ECMAScript 6 (Harmony)
  @see http://wiki.ecmascript.org/doku.php?id=harmony:direct_proxies

  With ES6-shim(https://github.com/paulmillr/es6-shim) it
  could also work in Firefox4 or Chrome.

  @author hagino3000(http://twitter.com/hagino3000)

 *
 */(function(a){function g(a,b){var d=a.match(c);return d&&f.isStruct(b)?(console.log(d[1]),console.log(f.getType(b)),f.getType(b)===d[1]):!1}function h(a,b){return e[a]?e[a](b):!1}function i(a,b){return{getOwnPropertyDescriptor:function(b){var c=Object.getOwnPropertyDescriptor(a,b);return c!==undefined&&(c.configurable=!0),c},getPropertyDescriptor:function(b){var c=Object.getPropertyDescriptor(a,b);return c!==undefined&&(c.configurable=!0),c},getOwnPropertyNames:function(){return Object.getOwnPropertyNames(a)},getPropertyNames:function(){return Object.getPropertyNames(a)},defineProperty:function(a,b){throw"Cannot fix this object"},"delete":function(c){if(c in b)return delete a[c];throw c+" is not defined in this struct"},fix:function(){return Object.isFrozen(a)?Object.getOwnPropertyNames(a).map(function(b){return Object.getOwnPropertyDescriptor(a,b)}):undefined},has:function(b){return b in a},hasOwn:function(b){return Object.prototype.hasOwnProperty.call(a,b)},get:function(c,d){if(d in b)return a[d];throw d+" is not defined in this struct"},set:function(c,d,e){if(d in b){var f=this.getOwnPropertyDescriptor(d);if(!f||!f.writable)throw d+" is not writable property";var i=b[d].type;if(e!==null&&e!==undefined&&!g(i,e)&&!h(i,e))throw d+" must be "+b[d].type+" type";return a[d]=e,!0}throw d+" is not defined in this struct"},enumerate:function(){var b=[];for(var c in a)b.push(c);return b},keys:function(){return Object.keys(a)}}}function j(){return{string:l,number:m,"boolean":n,"function":o,array:p,arraylike:q,object:r,anyobject:s,regexp:t,date:u,domnode:v}}function k(a){return Object.prototype.toString.call(a)}function l(a){return k(a)==="[object String]"}function m(a){return k(a)==="[object Number]"&&!isNaN(a)}function n(a){return k(a)==="[object Boolean]"}function o(a){return k(a)==="[object Function]"}function p(a){return k(a)==="[object Array]"}function q(a){return p(a)||a&&typeof a=="object"&&m(a.length)}function r(a){return k(a)==="[object Object]"}function s(a){return a!==null&&typeof a=="object"}function t(a){return k(a)==="[object RegExp]"}function u(a){return k(a)==="[object Date]"}function v(a){return a&&l(a.nodeName)&&q(a.childNodes)}"use strict";if(typeof f!="undefined")return;var b="__structName__",c=/^struct:(.+)/,d=window.Proxy&&o(Proxy.create),e=j(),f=a.Struct={structs:{}};f.define=function(a,c){if(!l(a))throw"First argument must be String type (Struct name)";if(!r(c))throw"Second argument must be Object type (Property settings)";if(this.structs[a])throw a+" is already defined";Object.keys(c).forEach(function(a){c[a].writable===undefined&&(c[a].writable=!0)}),c[b]={value:a,wriatble:!1,enumerable:!1},Object.freeze(c),this.structs[a]=c},f.getType=function(a){if(!s(a))throw"First argument must be object type";return r(a)&&a.hasOwnProperty(b)?a[b]:undefined},f.isStruct=function(a){return r(a)&&l(a[b])},f.create=function(a,b){if(!this.structs.hasOwnProperty(a))throw'Struct named "'+a+'" is not defined';b=b||{};var c=this.structs[a];Object.defineProperties(b,c);var e;return d?e=Proxy.create(i(b,c)):e=Object.seal(b),e}})(this);